$.fn.thecalendar=function(e){let t=$(this),a=["yyyy-mm-dd","dd-mm-yyyy","yyyy/mm/dd","dd/mm/yyyy",],n="dd-mm-yyyy",r=["month","year"],d=new Date;e||(e={});let o=(e,t)=>{t||(t=n),t=t.toLowerCase();let a=new Date,r=e.split(/[-/]/);return"yyyy-mm-dd"===t&&(a=new Date(r[0],r[1]-1,r[2])),"dd-mm-yyyy"===t&&(a=new Date(r[2],r[1]-1,r[0])),"yyyy/mm/dd"===t&&(a=new Date(r[0],r[1]-1,r[2])),"dd/mm/yyyy"===t&&(a=new Date(r[2],r[1]-1,r[0])),a},i=(e,t="")=>{let r=!1;if(t&&!a.includes(t.toLowerCase()))throw Error("Invalid date format. Please use valid date format. \n\n"+a.join("\n"));let d=t?[t]:a;for(let o=0;o<d.length;o++){let i=d[o],h=e.split(/[-/]/),l=i.split(/[-/]/),y=!1,s=!1,p=!1;if(h.length===l.length){for(let g=0;g<l.length;g++)if("yyyy"===l[g]&&4===h[g].length&&(y=!0),"mm"===l[g]&&2===h[g].length&&h[g]>=1&&h[g]<=12&&(s=!0),"dd"===l[g]&&2===h[g].length&&h[g]>=1&&h[g]<=31&&(p=!0),y&&s&&p){n=i,r=!0;break}}}return r},h=e=>new Date(2021,e).toLocaleString("default",{month:"long"});if(e.date){if("string"==typeof e.date){if(i(e.date))d=o(e.date);else throw Error("Invalid date format. Please use valid date format. \n\n"+a.join("\n"))}else if("object"==typeof e.date){if(e.date instanceof Date)d=e.date;else if(e.date.date&&e.date.format){if(!i(e.date.date,e.date.format))throw Error("Date format does not match with the provided date");d=o(e.date.date,e.date.format)}else if(Array.isArray(e.date)){let l=e.date[0],y=e.date[1];if(i(l,y))d=o(l,y);else throw Error("Invalid date format. Please use valid date format. \n\n"+a.join("\n"))}}}console.log($.fn.thecalendar.defaults);let s=function(){};var p={today:$.fn.thecalendar.defaults.today||!0,date:$.fn.thecalendar.defaults.date||d,type:$.fn.thecalendar.defaults.type||"month",highlightDates:[]};let g={today:e.today||p.today,date:d||p.date,type:e.type?e.type.toLowerCase():p.type};["onDateClick","onMonthChange","onYearChange","onBeforeInit","onAfterInit","onBeforeMonthChange","onBeforeYearChange","onViewChange","onHighlightDatesClick",].forEach(t=>{e[t]&&"function"==typeof e[t]?g[t]=e[t]:g[t]=$.fn.thecalendar.defaults[t]||s}),"function"==typeof e.highlightDates?g.highlightDates=e.highlightDates():g.highlightDates=e.highlightDates||p.highlightDates,g.onBeforeInit(t,g);let m={year:new Date(g.date).getFullYear(),month:new Date(g.date).getMonth(),type:g.type};function c(e,t){return new Date(t,e+1,0).getDate()}let v=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday",],_=(e,t)=>{let a=new Date(t,e).toLocaleString("default",{month:"long"}),n={monthName:a,monthIndex:e,prevMonthIndex:new Date(t,e-1).getMonth(),prevYear:new Date(t,e-1).getFullYear(),nextMonthIndex:new Date(t,e+1).getMonth(),currentYear:t,nextYear:new Date(t,e+1).getFullYear(),weeks:[],totalDaysInMonth:c(e,t),totalWeeksInMonth:Math.ceil((c(e,t)+new Date(t,e,1).getDay())/7)},r=1,d=new Date(t,e,r);for(;d.getMonth()===e;){let o={days:[]};for(let i=0;i<7;i++){let h={};if(i===d.getDay()&&r<=c(e,t)){h.date=r;let l=(e+1).toString().padStart(2,"0"),y=r.toString().padStart(2,"0");h.dateString=`${y}-${l}-${t}`,h.weekday=v[i],h.inView=!0,h.isCurrentDate=new Date().getDate()===r&&new Date().getMonth()===e&&new Date().getFullYear()===t,r++,d=new Date(t,e,r)}else if(r>c(e,t)){h.date=r-c(e,t);let s=(e+2).toString().padStart(2,"0"),p=(r-c(e,t)).toString().padStart(2,"0");h.dateString=`${p}-${s}-${t}`,h.weekday=v[i],h.inView=!1,r++,d=new Date(t,e,r)}else{h.date=c(e,t)-new Date(t,e,1).getDay()+i+1;let g=e.toString().padStart(2,"0"),m=(c(e,t)-new Date(t,e,1).getDay()+i+1).toString().padStart(2,"0");h.dateString=`${m}-${g}-${t}`,h.weekday=v[i],h.inView=!1}o.days.push(h)}n.weeks.push(o)}return n},w=e=>{let t={currentYear:e,prevYear:e-1,nextYear:e+1,months:[]};for(let a=0;a<12;a++){let n=_(a,e);t.months.push(n)}return t},f=(e,t)=>{let a=_(e,t);return a},u=e=>{let t=$("<div></div>");t.addClass("days-list");for(let a=0;a<7;a++){let n=$("<div></div>");n.addClass("days"),n.text(v[a].substring(0,"months"===e?3:1)),t.append(n)}return t},C=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="100px" width="100px" xmlns="http://www.w3.org/2000/svg"><path d="M217.9 256L345 129c9.4-9.4 9.4-24.6 0-33.9-9.4-9.4-24.6-9.3-34 0L167 239c-9.1 9.1-9.3 23.7-.7 33.1L310.9 417c4.7 4.7 10.9 7 17 7s12.3-2.3 17-7c9.4-9.4 9.4-24.6 0-33.9L217.9 256z"></path></svg>',x=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="100px" width="100px" xmlns="http://www.w3.org/2000/svg"><path d="M294.1 256L167 129c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.3 34 0L345 239c9.1 9.1 9.3 23.7.7 33.1L201.1 417c-4.7 4.7-10.9 7-17 7s-12.3-2.3-17-7c-9.4-9.4-9.4-24.6 0-33.9l127-127.1z"></path></svg>',b=e=>{let t=new Date,a=t.getDate().toString().padStart(2,"0"),n;return e===`${a}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getFullYear()}`},S=e=>{let t=$("<div></div>");return $.each(e.weeks,function(e,a){let n=$("<div></div>");n.addClass("day-row"),$.each(a.days,function(e,t){data_dateString=t.date?`data-date="${t.dateString}"`:"",data_day=t.weekday?`data-day="${t.weekday}"`:"",dateValue=t.date?t.date:"",isToday=g.today&&b(t.dateString)?" today":"",isHighlighted=g.highlightDates.includes(t.dateString);let a=$("<div></div>");a.addClass("days"),g.today&&b(t.dateString)&&a.addClass("today"),g.highlightDates.includes(t.dateString)&&a.addClass("thecalendar-highlight"),t.inView||a.addClass("disabled"),a.attr("data-date",t.dateString),a.attr("data-day",t.weekday),a.text(dateValue),n.append(a)}),t.append(n)}),t.html()},M=e=>{let t=$(`<div class="${g.type}-heading"></div>`),a=$(`<div class="heading-text">${e.monthName}</div>`),n=$(`<div class="heading-text year-title">${e.currentYear}</div>`);n.attr("data-year",e.currentYear),n.attr("data-month",e.monthIndex),n.attr("data-type","year"),t.append(a),t.append(n);let r=$('<div class="thecalendar-navigation-wrapper"></div>'),d=$(`<button class="prev thecalendar-navigation-btn" data-type="month" data-month="${e.prevMonthIndex}" data-year="${e.prevYear}">${C()}</button>`),o=$(`<button class="next thecalendar-navigation-btn" data-type="month" data-month="${e.nextMonthIndex}" data-year="${e.nextYear}">${x()}</button>`);r.append(d),r.append(o);let i=$("<div></div>");return i.append(t),i.append(r),i.html()},Y=e=>{let t=$(`<div class="${g.type}-heading"></div>`),a=$('<div class="thecalendar-navigation-wrapper"></div>'),n=$(`<button class="prev thecalendar-navigation-btn" data-type="year" data-year="${e.prevYear}">${C()}</button>`),r=$(`<div class="heading-text">${e.currentYear}</div>`),d=$(`<button class="next thecalendar-navigation-btn" data-type="year" data-year="${e.nextYear}">${x()}</button>`);return a.append(n),a.append(r),a.append(d),t.append(a),t},D=e=>{let a=$(`<div class="thecalendar ${g.type}-view"></div>`),n=$('<div class="thecalendar-inner"></div>'),r=$(`<div class="thecalendar-header thecalendar-header-${g.type}-wrapper"></div>`);r.html(M(e));let d=$(`<div class="thecalendar-body thecalendar-${g.type}-body"></div>`),o=$(`<div class="thecalendar-${g.type}-inner"></div>`),i=u("months"),h=$(i),l=$(`<div class="dates">${S(e)}</div>`);o.append(h),o.append(l),d.append(o),n.append(r),n.append(d),a.append(n),t.html(a)},k=e=>{let a=u("years"),n=$(`<div class="thecalendar ${g.type}-view"></div>`),r=$('<div class="thecalendar-inner"></div>'),d=$(`<div class="thecalendar-header thecalendar-header-${g.type}-wrapper"></div>`);d.html(Y(e));let o=$(`<div class="thecalendar-body thecalendar-${g.type}-body"></div>`),i=$(`<div class="thecalendar-${g.type}-inner"></div>`);e.months.forEach(e=>{let t=$('<div class="months-wrapper"></div>'),n=$(`<div class="month-name" role="button" data-month="${e.monthIndex}" data-year="${e.currentYear}" data-type="month">${e.monthName}</div>`),r=$(a),d=$('<div class="dates"></div>');d.html(S(e)),t.append(n),t.append(r),t.append(d),i.append(t)}),o.append(i),r.append(d),r.append(o),n.append(r),t.html(n)},I=()=>{let e=g.type,t=m.year,a=m.month,n={};"year"===e?(n=w(t),k(n)):(n=f(a,t),D(n))},L=e=>{g.type=e.type,m={...m,...e},I()},N=()=>{t.on("click",".thecalendar-navigation-btn",function(){let e=$(this),a=e.attr("data-month")||null,n=e.attr("data-year")||null,r=m.year,d=m.month;m.year=parseInt(n),m.month=parseInt(a),L({type:e.attr("data-type"),year:m.year,month:m.month});if("year"===e.attr("data-type")){g.onBeforeYearChange(t,{year:r});let o={year:m.year,oldYear:r};t.trigger("tc.year.change",o),g.onYearChange(t,o)}else{g.onBeforeMonthChange(t,{year:r,month:d,monthName:h(d)});let i={year:m.year,month:m.month,oldMonth:d,monthName:h(m.month),oldMonthName:h(d)};t.trigger("tc.month.change",i),g.onMonthChange(t,i)}}),t.on("click",".days",function(){let e=$(this),a=e.attr("data-date")||null,n=e.attr("data-day")||null,r=e.hasClass("thecalendar-highlight"),d=e.closest(".months-wrapper").find(".month-name").data("month")||null,o={date:a,day:n,month:d,monthName:h(d),year:m.year,isHighlighted:r};if(r){let i={...o,highlightDates:g.highlightDates};t.trigger("tc.highlight.click",i),g.onHighlightDatesClick(t,i)}else t.trigger("tc.date.click",o),g.onDateClick(t,o)}),t.on("click",".thecalendar-year-body .month-name,.thecalendar-header-month-wrapper .year-title",function(){let e=$(this),a=e.attr("data-month")||null,n=e.attr("data-year")||null,r=e.attr("data-type")||null;m.year=parseInt(n),m.month=parseInt(a),m.type=r,g.onViewChange(t,{type:r,year:m.year,month:m.month}),L({type:r,year:m.year,month:m.month})}),t.on("click",".thecalendar-year-body .year-title",function(){let e=$(this),t=e.attr("data-year")||null,a=e.attr("data-type")||null;m.year=parseInt(t),m.type=a,L({type:"year",year:m.year,month:m.month})})};function P(){I(),N()}P();let B={elements:{main:t,header:t.find(".thecalendar-header"),body:t.find(".thecalendar-body"),prevBtn:t.find(".thecalendar-navigation-btn.prev"),nextBtn:t.find(".thecalendar-navigation-btn.next")},getCalendarMode:()=>m,updateCalendarMode(e){m={...m,...e},L({type:m.type,year:m.year,month:m.month})},setYear(e){if(null==e)throw Error("Please provide a year");if("number"!=typeof e)throw Error("Please provide a valid year");if(4!==e.toString().length)throw Error("Invalid year. Please provide a valid year");m.year=e,L({type:m.type,year:m.year,month:m.month})},setMonth(e){if("year"===m.type)throw Error("Cannot set month in year view");if(null==e)throw Error("Please provide a month");if("number"!=typeof e)throw Error("Please provide a valid month");if(e<0||e>11)throw Error("Invalid month. Please provide a month between 0 and 11");m.month!==e&&(m.month=e-1,L({type:m.type,year:m.year,month:m.month}))},getCurrentMonthName(){if("year"===m.type)throw Error("Cannot get month name in year view");return h(m.month)},getNextMonthName(){if("year"===m.type)throw Error("Cannot get month name in year view");return h(11===m.month?0:m.month+1)},getPrevMonthName(){if("year"===m.type)throw Error("Cannot get month name in year view");return h(0===m.month?11:m.month-1)},getCurrentYear:()=>m.year,getNextYear:()=>m.year+1,getPrevYear:()=>m.year-1,getHighlightDates:()=>g.highlightDates,changeView(e){if(r.includes(e.toLowerCase()))e.toLowerCase()!==m.type&&(m.type=e.toLowerCase(),m.month=new Date().getMonth(),L({type:m.type,year:m.year,month:m.month}));else throw Error("Invalid view type. Please provide a valid view type")},nextMonth(){let e=m.month,t=11===e?0:e+1,a=0===t?m.year+1:m.year;L({type:m.type,year:a,month:t})},prevMonth(){let e=m.month,t=0===e?11:e-1,a=11===t?m.year-1:m.year;L({type:m.type,year:a,month:t})},nextYear(){let e=m.year+1;L({type:m.type,year:e,month:m.month})},prevYear(){let e=m.year-1;L({type:m.type,year:e,month:m.month})},destroy:function e(){t.html("")},init:P};return setTimeout(()=>{t.trigger("tc.init",[B])},0),g.onAfterInit(t,B),B};